<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
     <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
        <link rel="stylesheet" href="https://code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">

    <!--Page Title-->
    <title>HIDE-Home page</title>

    <!--Meta Keywords and Description-->
    <meta name="keywords" content="">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>

    <!--Favicon-->
    <link rel="shortcut icon" href="images/download (1).webp" title="Favicon"/>

    <!-- Main CSS Files -->
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/css.stego my.css">
    <link href="js/mytry.html" rel="import" />

    

    <!-- Namari Color CSS -->
    <link rel="stylesheet" href="css/color.css">

    <!--Icon Fonts - Font Awesome Icons-->
    <link rel="stylesheet" href="css/font-awesome.min.css">

    <!-- Animate CSS-->
    <link href="css/animate.css" rel="stylesheet" type="text/css">

    <!--Google Webfonts-->
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700,800' rel='stylesheet' type='text/css'>
</head>
<body>
<div id="preloader">
    <div id="status" class="la-ball-triangle-path">
        <div></div>
        <div></div>
        <div></div>
    </div>
</div>
<div id="wrapper">

    <header id="banner" class="scrollto clearfix" data-enllax-ratio=>
        <div id="header" class="nav-collapse">
            <div class="row clearfix">
                <div class="col-1">
                    <div id="logo">
                        <img src="images/download (1).webp" id="banner-logo" alt="Landing Page"/>
                        <img src="images/download (1).webp" id="navigation-logo" alt="Landing Page"/>
                    </div>
                    <aside>
                        <ul class="social-icons">
                            <li>
                                <a target="_blank" title="Facebook" href="https://www.facebook.com/username">
                                    <i class="fa fa-facebook fa-1x"></i><span>Facebook</span>
                                </a>
                            </li>
                            <li>
                                <a target="_blank" title="Google+" href="https://en.wikipedia.org/wiki/Steganography">
                                    <i class="fa fa-google-plus fa-1x"></i><span>Google+</span>
                                </a>
                            </li>
                            <li>
                                <a target="_blank" title="Twitter" href="http://www.twitter.com/username">
                                    <i class="fa fa-twitter fa-1x"></i><span>Twitter</span>
                                </a>
                            </li>
                            <li>
                                <a target="_blank" title="Instagram" href="http://www.instagram.com/username">
                                    <i class="fa fa-instagram fa-1x"></i><span>Instagram</span>
                                </a>
                            </li>
                            <li>
                                <a target="_blank" title="behance" href="http://www.behance.net">
                                    <i class="fa fa-behance fa-1x"></i><span>Behance</span>
                                </a>
                            </li>
                        </ul>
                    </aside>
                    <nav id="nav-main">
                        <ul>
                            <li>
                                <a href="#banner">Home</a>
                            </li>
                            <li>
                                <a href="#about">About</a>
                            </li>
                            <li>
                                <a href="#EXPLAINATION">EXPLAINATION</a>
                            </li>
                            <li>
                                <a href="#Attacks">Attacks</a>
                            </li>
                            <li>
                                <a href="#VISUALIZE">VISUALIZE</a>
                            </li>
                            <li>
                                <a target="_blank" title="Google+" href="https://en.wikipedia.org/wiki/Steganography">
                                    <i class="fa fa-google-plus fa-1x"></i><span></span>
                            </li>
                            
                        </ul>
                    </nav>
                    <div id="nav-trigger"><span></span></div>
                    <nav id="nav-mobile"></nav>
                </div>
            </div>
        </div>
        <div id="banner-content" class="row clearfix">
            <div class="col-38">
                <div class="section-heading">
                    <h1>IMAGE STEGANOGRAPHY</h1>
                    <h2> Hiding data within an image </h2>
                </div>
                <a href="#VISUALIZE" class="button">START VISUALIZE</a>
            </div>
        </div>
    </header>
    <main id="content">
        <section id="about" class="introduction scrollto">
            <div class="row clearfix">
                <div class="col-3">
                    <div class="section-heading">
                        <h3>ABOUT</h3>
                        <h2 class="section-title">What is Steganography</h2>
                        <p class="section-subtitle">Steganography is the technique of hiding secret data within an ordinary, non-secret, file or message in order to avoid detection; the secret data is then extracted at its destination. The use of steganography can be combined with encryption as an extra step for hiding or protecting data</p>
                    </div>
                </div>
                <div class="col-2-3">
                    <div class="col-2 icon-block icon-top wow fadeInUp" data-wow-delay="0.1s">
                        <div class="icon">
                            <i class="fa fa-picture-o" aria-hidden="true"style="font-size:30px"></i>
                        </div>
                        <div class="icon-block-description">
                            <h4>Image Steganography </h4>
                            <p> Image Steganography refers to the process of hiding data within an image file. The image selected for this purpose is called the cover image and the image obtained after steganography is called the stego image.</p>
                        </div>
                    </div>
                    <div class="col-2 icon-block icon-top wow fadeInUp" data-wow-delay="0.3s">
                        <div class="icon">
                            <i class="fa fa-video-camera" aria-hidden="true"style="font-size:30px"></i>
                        </div>
                        <div class="icon-block-description">
                            <h4>Video Steganography</h4>
                            <p>Video steganography is the process of hiding secret information inside videos. The secret information can be any media like text, audio, images, video, and binary file and the carrier video can be raw/compressed in any format.</p>
                        </div>
                    </div>
                    <div class="col-2 icon-block icon-top wow fadeInUp" data-wow-delay="0.5s">
                        <div class="icon">
                            <i class="fa fa-music" aria-hidden="true"style="font-size:30px"></i>
                        </div>
                        <div class="icon-block-description">
                            <h4>Audio steganography</h4>
                            <p>Audio steganography is about hiding the secret message into the audio. It is a technique uses to secure the transmission of secret information or hide their existence. It also may provide confidentiality to secret message if the message is encrypted.</p>
                        </div>
                    </div>
                    <div class="col-2 icon-block icon-top wow fadeInUp" data-wow-delay="0.5s">
                        <div class="icon">
                            <i class="fa fa-shield" aria-hidden="true"style="font-size:30px"></i>
                        </div>
                        <div class="icon-block-description">
                            <h4>Network Steganography</h4>
                            <p>Network Steganography is a technique that uses common network protocols (the header field, the payload field or both) to hide a secret message.Some of the approaches for achieving this type of steganography are: storage-based methods, timing-based methods, and hybrid </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <div id="EXPLAINATION" class="scrollto clearfix">
            <div class="row no-padding-bottom clearfix">
                <div class="col-3">
                </div> 
                <div class="">
                    <div class="section-heading">
                        <h3>EXPLAINATION</h3>
                        <h2 class="section-title">IMAGE STEGANOGRAPHY</h2>
                        <p class="section-subtitle">Online steganography explaination</p>
                    </div>
                    <p>Each channel (red, green, blue) of each pixel in an image is represented by an 8-bit value. To hide the secret image
                        inside the cover image, we replace the <b>n</b> least significant bits of the cover pixel value with the same number of most significant
                        bits from the secret pixel value. Example, using 3 hidden bits:</p>
                    </div>
                        <p>Cover pixel: (167, 93, 27) == (<b>10100</b>111, <b>01011</b>101, <b>00011</b>011) <span style="background-color:rgb(167,93,27)">&nbsp;&nbsp;&nbsp;</span><br>
                        Secret pixel: (67, 200, 105) == (<b>010</b>00011, <b>110</b>01000, <b>011</b>01001) <span style="background-color:rgb(67,200,105)">&nbsp;&nbsp;&nbsp;</span><br>
                        Output pixel: (162, 94, 27) == (10100<b>010</b>, 01011<b>110</b>, 00011<b>011</b>) <span style="background-color:rgb(162,94,27)">&nbsp;&nbsp;&nbsp;</span>
                        </p>
                    </p>
                    <p>
                        The output colour is almost indistinguishable from the cover colour, but now contains information
                        to extract an approximation of the secret pixel value, which gets padded with 0 to fill in the missing bits, so comes out to
                        (64, 192, 96) ==
                        (<b>010</b>00000, <b>110</b>00000, <b>011</b>00000) <span style="background-color:rgb(64,192,96)">&nbsp;&nbsp;&nbsp;</span>.</p>
                        Using a larger number of hidden bits results in a better quality hidden image, but makes it easier to tell that the hidden
                        image is there. Play with the 'hidden bits' slider to see.
                        There is an example on Wikipedia of a cat hidden in a picture of a tree. To do the example here, use the 'Unhide image' tool
                        to select the 'Wikipedia tree' example, and set hidden bits to 2.All of the computation is performed in your browser in Javascript. Be careful with larger images as it can be quite slow.
                        Once you've hidden your secret image inside a cover image, send the output image to your accomplice. Your accomplice then
                        uses the 'Unhide image' tool to recover the secret image
                    </p>
                    <p>The output colour is almost indistinguishable from the cover colour, but now contains information
                        to extract an approximation of the secret pixel value, which gets padded with 0 to fill in the missing bits, so comes out to
                        (64, 192, 96) ==
                        (<b>010</b>00000, <b>110</b>00000, <b>011</b>00000) <span style="background-color:rgb(64,192,96)">&nbsp;&nbsp;&nbsp;</span>.
                        Using a larger number of hidden bits results in a better quality hidden image, but makes it easier to tell that the hidden
                        image is there. Play with the 'hidden bits' slider to see.
                        There is an example on Wikipedia of a cat hidden in a picture of a tree. To do the example here, use the 'Unhide image' tool
                        to select the 'Wikipedia tree' example, and set hidden bits to 2.
                        All of the computation is performed in your browser in Javascript. Be careful with larger images as it can be quite slow.
                        Once you've hidden your secret image inside a cover image, send the output image to your accomplice. Your accomplice then
                        uses the 'Unhide image' tool to recover the secret image.</p>
        </div>
        <aside id="Attacks" class="scrollto text-center" data-enllax-ratio=".2">
            <div class="row clearfix">
                <div class="section-heading">
                    <h3>ATTACKS</h3>
                    <h2 class="section-title">Steganography Based Security Attacks</h2>
                </div>
                <blockquote class="col-3 testimonial classic">
                    <q>In known cover attacks an attacker gets access to cover images along with their respective stego images
                        In such cases giving access to such images can be constrained by posing limitations on the quantities and complexities of the involved polynomials</q>
                    <footer>Known cover attack</footer>
                </blockquote>
                <blockquote class="col-3 testimonial classic">
                    <q>Steganography algorithms are used by hackers in this case for performing the embedding processes in multiple messages
                        Also the processes of data extraction can be performed with the previous knowledge accrued from known cover attacks
                        Within the constraints posed by polynomial handling capabilities, the operations of invocation are limited</q>
                    <footer>Chosen cover attack</footer>
                </blockquote>
                <blockquote class="col-3 testimonial classic">
                    <q>The consecutive attempts of  chosen cover attack until it becomes successful is called Adaptive chosen cover attack</q>
                    <footer>Adaptive Chosen Cover Attack</footer>
                </blockquote>
            </div>
        </aside>
        <section id="VISUALIZE" class="scrollto clearfix">
            <div class="section-heading">
                <div class="container">
                    <div style="float:left">
                <h3>VISUALIZE</h3>
                <h2 class="section-title">Hide images inside other images</h2>
                <body onload="hideImage()">
                    <div class="container">
                        <div style="float:left">
                        <h1>Image Steganography</h1>
                        </div>
                      <div class="row" style="padding-bottom: 20px">
                            <div class="col-md-12">
                                <div class="btn-group">
                                    <button class="btn btn-primary" id="hide-switch">Hide image</button>
                                    <button class="btn btn-default" id="unhide-switch">Unhide image</button>
                                </div>
                            </div>
                        </div>
                        <div id="hiderow" class="row">
                            <div class="col-md-4" style="padding-bottom: 40px">
                                <div style="height: 100px">
                                    Cover image:<input type="file" id="cover"/><br>
                        
                                    
                                </div>
                                <canvas style="border: solid 1px black" width="300" height="300" id="covercanvas"></canvas>
                            </div>
            
                            <div class="col-md-4" style="padding-bottom: 40px">
                                <div style="height: 100px">
                                    Secret image:<input type="file" id="secret"/><br>
                                
                                   
                                </div>
                                <canvas style="border: solid 1px black" width="300" height="300" id="secretcanvas"></canvas>
                            </div>
            
                            <div class="col-md-4" style="padding-bottom: 40px">
                                <div style="height: 100px">
                                    Hidden bits:
                                    <span id="bitsdisplay">1</span><div id="bits" style="margin-top: 10px; width: 300px"></div>
                                    
                                </div>
            
                                <canvas style="border: solid 1px black" width="300" height="300" id="outputcanvas"></canvas>
                                <button class="btn btn-default" style="margin-top: 10px" id="downloadbutton">Download Full-size Image</button>
                            </div>
                        </div>
            
            
                        <div id="unhiderow" class="row">
                            <div class="col-md-4" style="padding-bottom: 40px">
                                <div style="height: 100px">
                                    Image:<input type="file" id="stegimage"/><br>
                                    
                                    
                                </div>
                                <canvas style="border: solid 1px black" width="300" height="300" id="stegcanvas"></canvas>
                            </div>
            
                            <div class="col-md-4" style="padding-bottom: 40px">
                                <div style="height: 100px">
                                    Hidden bits:
                                    <span id="unhidebitsdisplay">1</span><div id="bits2" style="margin-top: 10px; width: 300px"></div>
                                  
                                </div>
            
                                <canvas style="border: solid 1px black" width="300" height="300" id="hiddencanvas"></canvas>
                                <button class="btn btn-default" style="margin-top: 10px" id="downloadbutton2">Download Full-size Image</button>
            
                            </div>
                        </div>
                        <div class="modal" id="fullimgmodal" tabindex="-1" role="dialog">
                            <div class="modal-dialog" role="document">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                        <h4 class="modal-title" id="myModalLabel">Save image</h4>
                                    </div>
                                    <div class="modal-body">
                                        <span id="loadingspan"></span><br>
                                        <img style="max-width: 100%" id="viewimg">
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                    </div>
                                </div>
                            </div>
                        </div>
        </section>
    </main>
    <footer id="landing-footer" class="clearfix">
        <div class="row clearfix">

            <p id="copyright" class="col-2">@Made by anonymous in 2023</a></p>  
    </footer>

</div>
<script src="js/jquery.1.8.3.min.js"></script>
<script src="js/wow.min.js"></script>
<script src="js/featherlight.min.js"></script>
<script src="js/featherlight.gallery.min.js"></script>
<script src="js/jquery.enllax.min.js"></script>
<script src="js/jquery.scrollUp.min.js"></script>
<script src="js/jquery.easing.min.js"></script>
<script src="js/jquery.stickyNavbar.min.js"></script>
<script src="js/jquery.waypoints.min.js"></script>
<script src="js/images-loaded.min.js"></script>
<script src="js/lightbox.min.js"></script>
<script src="js/site.js"></script>
<script type="text/javascript" src="https://code.jquery.com/jquery-2.2.3.min.js"></script>
<script type="text/javascript" src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
<script type="text/javascript" src="hideimage.js"></script>
<script>
$('#cover').change(function(e) {
    changed = true;
    loadImage('cover', drawImagePreview);
    $('#cover-preset').val('na');
});

$('#cover-preset').change(function(e) {
    changed = true;
    loadPresetImage('cover', drawImagePreview);
});

$('#secret').change(function(e) {
    changed = true;
    loadImage('secret', drawImagePreview);
});

$('#secret-preset').change(function(e) {
    changed = true;
    loadPresetImage('secret', drawImagePreview);
});

$('#bits').slider({
    min: 1,
    max: 7,
    slide: function(e, ui) {
        $('#bitsdisplay').text(ui.value);
        changed = true;
        if (loaded_img["cover"] && loaded_img["secret"])
            makeHideImagePreview(ui.value);
    },
});

$('#stegimage').change(function(e) {
    changed = true;
    loadImage('stegimage', drawUnhideImagePreview);
});

$('#stegimage-preset').change(function(e) {
    changed = true;
    loadPresetImage('stegimage', drawUnhideImagePreview);
});

$('#bits2').slider({
    min: 1,
    max: 7,
    slide: function(e, ui) {
        $('#unhidebitsdisplay').text(ui.value + " (release to process)");
    },
    change: function(e, ui) {
        $('#unhidebitsdisplay').text(ui.value);
        $('#unhidethrob').show();
        setTimeout(function() {
            changed = true;
            if (loaded_img["stegimage"])
                makeUnhideImagePreview(ui.value);
        }, 20);
    },
});

$('#unhiderow').hide();

$('#hide-switch').click(hide_switch);
$('#unhide-switch').click(unhide_switch);

function hide_switch() {
    $('#hiderow').show();
    $('#unhiderow').hide();
    $('#hide-switch').addClass('btn-primary');
    $('#hide-switch').removeClass('btn-default');
    $('#unhide-switch').addClass('btn-default');
    $('#unhide-switch').removeClass('btn-primary');
    if (window.location.hash)
        window.location.hash = '';
}

function unhide_switch() {
    $('#unhiderow').show();
    $('#hiderow').hide();
    $('#unhide-switch').addClass('btn-primary');
    $('#unhide-switch').removeClass('btn-default');
    $('#hide-switch').addClass('btn-default');
    $('#hide-switch').removeClass('btn-primary');
    window.location.hash = 'unhide';
}

if (window.location.hash == '#unhide')
    unhide_switch();

var changed = true;

$('#downloadbutton').prop('disabled', true);
$('#downloadbutton2').prop('disabled', true);

$('#downloadbutton').click(function(e) {
    if (!loaded_img["cover"] || !loaded_img["secret"]) {
        return;
    }

    $('#fullimgmodal').modal('show');

    if(!changed)
        return;

    $('#viewimg').hide();

    $('#loadingspan').text("Processing...");
    setTimeout(function() {
        var cover = document.createElement('canvas');
        var secret = document.createElement('canvas');

        cover.width = loaded_img["cover"].width;
        cover.height = loaded_img["cover"].height;
        secret.width = loaded_img["secret"].width;
        secret.height = loaded_img["secret"].height;

        var coverctx = cover.getContext('2d');
        var secretctx = secret.getContext('2d');

        coverctx.clearRect(0, 0, cover.width, cover.height);
        coverctx.drawImage(loaded_img["cover"], 0, 0);
        secretctx.clearRect(0, 0, secret.width, secret.height);
        secretctx.drawImage(loaded_img["secret"], 0, 0);

        var coverdata = coverctx.getImageData(0, 0, cover.width, cover.height);
        var secretdata = secretctx.getImageData(0, 0, secret.width, secret.height);
        doHideImage(coverdata, secretdata, $('#bits').slider('value'));

        $('#loadingspan').text("Displaying...");
        setTimeout(function() {
            coverctx.putImageData(coverdata, 0, 0);
            changed = false;

            $('#viewimg').attr('src', cover.toDataURL());
            $('#viewimg').show();

            $('#loadingspan').html("Right click and save the image.<br>Use the 'Unhide image' tool to retrieve the hidden image.");
        }, 20);
    }, 20);
});

$('#downloadbutton2').click(function(e) {
    if (!loaded_img["stegimage"]) {
        return;
    }

    $('#fullimgmodal').modal('show');

    if(!changed)
        return;

    $('#viewimg').hide();

    $('#loadingspan').text("Displaying...");
    setTimeout(function() {
        changed = false;

        $('#viewimg').attr('src', stegdataurl);
        $('#viewimg').show();

        $('#loadingspan').text("Right click and save the image.");
    }, 20);
});

function downloadCanvas(link, canvas, filename) {
    link.href = canvas.toDataURL();
    link.download=filename;
}

var factor = {
    "cover": 0.001,
    "secret": 0.001,
};
var k = 0.001;
var opposite = {
    "cover": "secret",
    "secret": "cover",
};

var loaded_img = {
    "cover": undefined,
    "secret": undefined,
    "stegimage": undefined,
};

var stegdataurl;

function drawImagePreview(which, recursed) {
    var id = '#' + which + 'canvas';

    var ctx = $(id)[0].getContext('2d');

    var targetw = $(id)[0].width;
    var targeth = $(id)[0].height;

    var img = loaded_img[which];
    var imgw = img.width;
    var imgh = img.height;
    var wfactor = img.width / targetw;
    var hfactor = img.height / targeth;
    factor[which] = wfactor;
    if (hfactor > factor[which])
        factor[which] = hfactor;

    k = factor[which];
    if (factor[opposite[which]] > factor[which])
        k = factor[opposite[which]];

    ctx.clearRect(0, 0, targetw, targeth);
    ctx.drawImage(img, 0, 0, imgw / k, imgh / k);

    if (loaded_img[opposite[which]]) {
        if (!recursed) {
            drawImagePreview(opposite[which], 1);
        } else {
            makeHideImagePreview($('#bits').slider('value'));
        }
    }
}

function drawUnhideImagePreview() {
    var ctx = $('#stegcanvas')[0].getContext('2d');

    var imgw = loaded_img["stegimage"].width;
    var imgh = loaded_img["stegimage"].height;

    var k = imgw / 300;
    if ((imgh / 300) > k)
        k = imgh / 300;

    ctx.clearRect(0, 0, 300, 300);
    ctx.drawImage(loaded_img["stegimage"], 0, 0, imgw / k, imgh / k);

    makeUnhideImagePreview();
}

function makeHideImagePreview(bits) {
    $('#downloadbutton').prop('disabled', false);
    var ctx = $('#outputcanvas')[0].getContext('2d');
    ctx.clearRect(0, 0, 300, 300);
    ctx.font = '15px sans-serif';
    ctx.fillText("Processing...", 10, 30);

    setTimeout(function() {
        var coverctx = $('#covercanvas')[0].getContext('2d');
        var coverdata = coverctx.getImageData(0, 0, loaded_img["cover"].width/k, loaded_img["cover"].height/k);
        var secretctx = $('#secretcanvas')[0].getContext('2d');
        var secretdata = secretctx.getImageData(0, 0, loaded_img["secret"].width/k, loaded_img["secret"].height/k);

        doHideImage(coverdata, secretdata, bits);

        ctx.clearRect(0, 0, 300, 300);
        ctx.putImageData(coverdata, 0, 0);
    }, 20);
}

function makeUnhideImagePreview() {
    $('#downloadbutton2').prop('disabled', false);
    var ctx = $('#hiddencanvas')[0].getContext('2d');
    ctx.clearRect(0, 0, 300, 300);
    ctx.font = '15px sans-serif';
    ctx.fillText("Processing...", 10, 30);

    setTimeout(function() {
        var steg = document.createElement('canvas');

        var imgw = loaded_img["stegimage"].width;
        var imgh = loaded_img["stegimage"].height;

        steg.width = imgw;
        steg.height = imgh;
        var stegctx = steg.getContext('2d');
        stegctx.drawImage(loaded_img["stegimage"], 0, 0, imgw, imgh);
        var stegdata = stegctx.getImageData(0, 0, imgw, imgh);

        doUnhideImage(stegdata, $('#bits2').slider('value'));

        var k = imgw / 300;
        if ((imgh / 300) > k)
            k = imgh / 300;

        var img = new Image();
        img.onload = function() {
            ctx.clearRect(0, 0, 300, 300);
            ctx.drawImage(img, 0, 0, imgw / k, imgh / k);
        }
        stegctx.putImageData(stegdata, 0, 0);
        stegdataurl = steg.toDataURL();
        img.src = stegdataurl;
    }, 20);
}

function loadImage(which, cb) {
    var input = $('#' + which)[0];

    loaded_img[which] = undefined;

    var img = new Image;
    img.onload = function() {
        loaded_img[which] = img;
        cb(which);
    }
    img.src = URL.createObjectURL(input.files[0]);
}

function loadPresetImage(which, cb) {
    loaded_img[which] = undefined;

    var img = new Image;
    img.onload = function() {
        loaded_img[which] = img;
        cb(which);
    }
    img.src = $('#'+which+'-preset').val() + '.png';
}

function hideImage() {
    loadImage('cover', drawImagePreview);
    loadImage('secret', drawImagePreview);
}


function doHideImage(coverdata, secretdata, bits) {
    var coverpix = coverdata.data;
    var secretpix = secretdata.data;

    var minw = coverdata.width;
    var minh = coverdata.height;
    if (secretdata.width < minw)
        minw = secretdata.width;
    if (secretdata.height < minh)
        minh = secretdata.height;

    var mask = (0xff >>> bits) << bits;

    for (var y = 0; y < minh; y++) {
        var covery = y*coverdata.width;
        var secrety = y*secretdata.width;
        for (var x = 0; x < minw; x++) {
            var coveridx = 4 * (covery + x);
            var secretidx = 4 * (secrety + x);

            coverpix[coveridx] = (coverpix[coveridx] & mask) + (secretpix[secretidx] >>> (8 - bits));

           
            ++coveridx;
            coverpix[coveridx] = (coverpix[coveridx] & mask) + (secretpix[++secretidx] >>> (8 - bits));

            ++coveridx;
            coverpix[coveridx] = (coverpix[coveridx] & mask) + (secretpix[++secretidx] >>> (8 - bits));
        }
    }
}

function doUnhideImage(stegdata, bits) {
    var stegpix = stegdata.data;

    var w = stegdata.width;
    var h = stegdata.height;

    for (var y = 0; y < h; y++) {
        var stegy = y*w;
        for (var x = 0; x < w; x++) {
            var stegidx = 4*(stegy + x);

            stegpix[stegidx] = (stegpix[stegidx] << (8 - bits)) & 0xff;

            ++stegidx;
            stegpix[stegidx] = (stegpix[stegidx] << (8 - bits)) & 0xff;

            ++stegidx;
            stegpix[stegidx] = (stegpix[stegidx] << (8 - bits)) & 0xff;
        }
    }
}

</script>

</body>
</html>